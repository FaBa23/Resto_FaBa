"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8654],{75758:function(e,t,l){l.d(t,{Z:function(){return d}});var n=l(59658);l(46012);var i=l(71872),r=l(78115),o=l(91885);let a={default:"bg-white text-[#494A4A]",secondary:"bg-gf-support-warning-fill text-gf-content-secondary"};var d=e=>{let{iconUrl:t,text:l,variant:d="default"}=e;return(0,n.jsx)(i.Z,{className:(0,r.m)("gf-label-xs py-0 px-2 flex items-center gap-1.5 shrink-0 grow-0 w-fit h-6",a[d]),leftIcon:(0,n.jsx)(o.Z,{src:t,alt:"flash-sale-icon",width:16,height:16}),children:l})}},46058:function(e,t,l){var n=l(59658);l(46012);var i=l(78115),r=l(91885);t.Z=e=>{let{summaryLines:t,withTnc:l,onTncClick:o}=e;return(0,n.jsx)("ul",{className:"flex flex-col space-y-2",children:t.map(e=>{let t=l&&"TNC"===e.offer_id;return(0,n.jsxs)("li",{className:(0,i.m)("flex items-center ml-0.5",t?"gf-label-s md:gf-label-m text-gf-content-brand cursor-pointer":"gf-body-s text-gf-content-secondary"),onClick:t?o:()=>null,children:[(0,n.jsx)("div",{className:"shrink-0 flex mr-3",children:(0,n.jsx)(r.Z,{src:e.icon_url||"",alt:"line-item-icon",width:12,height:12})}),e.text]},e.offer_id)})})}},88654:function(e,t,l){l.d(t,{Z:function(){return L}});var n,i,r=l(59658),o=l(46012),a=l(4036),d=l(29469),s=l(91885),u=l(10269),c=l(12154),f=l(78115),m=l(7234),p=l(581),g=l(443);(n=i||(i={}))[n.APPLIED=0]="APPLIED",n[n.ELIGIBLE=1]="ELIGIBLE",n[n.INELIGIBLE=2]="INELIGIBLE";var x=e=>{let{onApplyPromo:t,onRemovePromo:l,nudge:n}=e,{t:a}=(0,d.Z)("common"),s=(0,o.useMemo)(()=>{var e;return null!==(e=({[i.INELIGIBLE]:"bg-gf-support-warning-fill text-gf-content-secondary",[i.ELIGIBLE]:"bg-gf-support-success-fill text-gf-content-brand",[i.APPLIED]:"bg-gf-support-success-default text-white"})[n.type])&&void 0!==e?e:""},[n]);return(0,r.jsxs)("div",{className:(0,f.m)("flex items-center pt-6 pb-2 px-6 rounded-b-2xl -mt-4",s),children:[(0,r.jsx)("div",{className:"flex py-2 items-center gf-label-s md:gf-label-m",children:n.text}),(0,r.jsxs)("div",{className:"ml-auto",children:[t&&n.type===i.ELIGIBLE&&(0,r.jsx)(g.default,{onClick:t,children:a("use_promo")}),l&&n.type===i.APPLIED&&(0,r.jsx)(g.default,{variant:"secondary",color:"danger",onClick:l,children:a("remove")})]})]})},v=l(46058),h=l(23002),b=l(75758),_=e=>{let{data:t,onApplyPromo:l,onRemovePromo:n,isApplied:u,className:g,backgroundUrl:_,type:y="merchant_profile",applicablePaymentMethods:j,nudgeConfig:I,totalSaved:N,onClick:L}=e,{id:E}=(0,a.useRouter)().query,{cartStorage:P}=(0,m.jD)(),{t:k,lang:C}=(0,d.Z)("outlet"),{title:w,sub_title:A,additional_line_item:B,logo:Z}=t,D="merchant_profile"===y,G=(0,o.useMemo)(()=>{var e;let{amount:l,min_spend:r}=t.additional_info,o=(0,c.V2)(l,C),a=i.INELIGIBLE,d="";if(D&&(null===(e=P.outlet)||void 0===e?void 0:e.uid)===(0,p.pB)(E||"")){if(P.finalPrice.units>=r)a=i.ELIGIBLE,d=k("promo_nudge_ready",{number:o});else{let e=r-P.finalPrice.units;d=k("promo_nudge_add_more",{number_add:(0,c.V2)(e,C),number_save:o})}}else if((null==j?void 0:j.length)&&I){let e=(0,h.p)(t.additional_info.nudges||[],j);if(e){let{template:t,arguments:l}=e,r=I[t],o="title"in r?r.title:r[0].title;d=(null==l?void 0:l.args.length)?(0,p.y9)(o,l.args.flat()):o,e.offer_applicable?(a=u?i.APPLIED:i.ELIGIBLE,u&&(d=k("promo_nudge_saved",{number:(0,c.V2)(N,C)}))):u&&(null==n||n())}}return{text:d,type:a}},[j,P.finalPrice.units,P.outlet,t.additional_info,u,D,I,n,k,E,N,C]),O=t.analytics_meta.is_flash_offer;return(0,r.jsxs)("div",{className:(0,f.m)(g,i[G.type].toLowerCase()),children:[(0,r.jsxs)("div",{className:(0,f.m)("relative box-border rounded-2xl bg-gf-background-fill-primary p-4 border border-gf-background-border-secondary",G.type===i.APPLIED&&"border-gf-content-brand"),style:O?{backgroundImage:"url(".concat(_,")"),backgroundPosition:"right 8px bottom 8px",backgroundRepeat:"no-repeat"}:{},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"gf-label-l",children:w}),A&&(0,r.jsx)("div",{className:"gf-label-xs text-gf-content-secondary mt-1",children:A})]}),Z&&(0,r.jsx)("div",{className:"rounded-xl bg-[#F7F7F7] p-2 pb-1.5",children:(0,r.jsx)(s.Z,{src:Z,alt:"promo-icon",width:40,height:40})})]}),(0,r.jsx)("div",{className:"my-3 mx-auto w-100 border-b border-gf-background-border-secondary"}),(0,r.jsx)(v.Z,{summaryLines:(0,h.b)(t)}),O&&(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)(b.Z,{iconUrl:B.icon_url,text:B.text,variant:"secondary"})})]}),G.text&&(0,r.jsx)(x,{onApplyPromo:D?void 0:()=>{null==l||l(t),null==L||L()},onRemovePromo:D?void 0:()=>{null==n||n(),null==L||L()},nudge:G})]})},y=l(41408),j=l(93645);let I=(e,t)=>{let l=(e,t)=>e<=t;return e.sort((e,n)=>{let{amount:i,min_spend:r}=e.additional_info,{amount:o,min_spend:a}=n.additional_info,{units:d}=t;if(0!==d){let e=l(r,d),t=l(a,d);if(e&&!t)return -1;if(!e&&t)return 1}if(i>o)return -1;if(i===o){if(r<a)return -1;if(r===a)return 0}return 1})},N=function(e,t,l,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=Object.keys(t).sort((e,l)=>t[e].priority-t[l].priority),o=i.map(e=>e.id);return e.filter(e=>-1==o.findIndex(t=>(0,p.rc)(t,e.id))).sort((e,t)=>{if(e.id===n)return -1;let i=(0,h.p)(e.additional_info.nudges||[],l),o=(0,h.p)(t.additional_info.nudges||[],l);if(!i||!o)return 0;let a=r.indexOf(i.template),d=r.indexOf(o.template);if(a<d)return -1;if(a>d)return 1;let{amount:s,min_spend:u}=e.additional_info,{amount:c,min_spend:f}=t.additional_info;if(s>c)return -1;if(s===c){if(u<f)return -1;if(u===f)return 0}return 1})};var L=e=>{let{offerList:t,onApplyPromo:l,onRemovePromo:n,isOpen:i,onClose:c,offerBar:f,type:g="merchant_profile",promoApplied:x,applicablePaymentMethods:v,nudgeConfig:h,totalSaved:b,highlightedOffers:L}=e,{cartStorage:E}=(0,m.jD)(),{t:P}=(0,d.Z)("common"),{discounts:k,highlighted_offers_section:C,other_offers_section:w}=t,A=(0,a.useRouter)(),{sendEvent:B}=(0,y.k)();(0,o.useEffect)(()=>{if(i){var e;let t=null===(e=E.outlet)||void 0===e?void 0:e.uid;if("merchant_profile"===g){let{id:e}=A.query;t=(0,p.pB)(e)}B("Offer List Page Shown","Component",{outlet:{id:t},offer:{countApplied:"merchant_profile"===g?0:x?1:0,countUnlocked:document.getElementsByClassName("eligible").length,countAvailable:k.length}})}},[i]);let Z=(0,o.useMemo)(()=>"merchant_profile"===g?I(k,E.finalPrice):h&&v?N(k,h,v,(null==x?void 0:x.uid)||"",L):k,[v,E.finalPrice,k,L,h,null==x?void 0:x.uid,g]),D=(e,t)=>{var n;l&&(B("Offer Selected – from COLP","Component",{...(0,j.A)(e,t),outlet:{id:null===(n=E.outlet)||void 0===n?void 0:n.uid}}),l(e))},G=e=>{var t;n&&(B("Offer Removed – from COLP","Component",{...(0,j.A)(null==x?void 0:x.offer,e),outlet:{id:null===(t=E.outlet)||void 0===t?void 0:t.uid}}),n())};return(0,r.jsx)(u.Z,{isOpen:i,cardClassName:"p-0",titleClassName:"px-6 pt-6",title:P("promo"),contentClassName:"p-6 pt-4",onClose:c,closeButtonVariant:"outer",isDisableInitialFocus:!0,titleIcon:f?(0,r.jsx)("div",{className:"flex mr-2",children:(0,r.jsx)(s.Z,{src:f.icon_url,alt:"modal-title-icon",width:40,height:40})}):void 0,children:(0,r.jsxs)("div",{className:"w-full md:w-[413px] lg:w-[580px]",children:[C&&L&&!!L.length&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"gf-label-m md:gf-label-l mb-4",children:C.title}),L.map(e=>{var t;return(0,r.jsx)(_,{data:e,backgroundUrl:null==f?void 0:null===(t=f.nudge)||void 0===t?void 0:t.bg_image_url,type:g,isApplied:(0,p.rc)((null==x?void 0:x.uid)||"",e.id),onApplyPromo:e=>D(e,"highlighted_offers"),onRemovePromo:()=>G("highlighted_offers"),applicablePaymentMethods:v,nudgeConfig:h,totalSaved:b,className:"mb-8",onClick:c},null==e?void 0:e.id)})]}),!!Z.length&&(0,r.jsxs)(r.Fragment,{children:[w&&(0,r.jsx)("div",{className:"gf-label-m md:gf-label-l mb-4",children:w.title}),(0,r.jsx)("div",{className:"flex flex-col space-y-3.5",children:Z.map(e=>{var t;return(0,r.jsx)(_,{data:e,backgroundUrl:null==f?void 0:null===(t=f.nudge)||void 0===t?void 0:t.bg_image_url,type:g,isApplied:(0,p.rc)((null==x?void 0:x.uid)||"",e.id),onApplyPromo:e=>D(e,"available"),onRemovePromo:()=>G("available"),applicablePaymentMethods:v,nudgeConfig:h,totalSaved:b,onClick:c},e.id)})})]})]})})}},93645:function(e,t,l){l.d(t,{A:function(){return n}});let n=(e,t)=>{if(!e)return{offer:{},voucher:{}};let{title:l,type:n,id:i,total_use_count:r,additional_info:{min_spend:o,amount:a,expiry_date:d,discount_types:s},analytics_meta:{is_flash_offer:u}}=e;return{offer:{sectionName:t?"".concat(t,"_section"):"highlighted_offers_section",isMarkdownCampaign:"markdown"===n,title:l,selectedId:i,type:n,usageCount:r,minSpend:o,nominalDiscountValue:a,expiry:d,isFlashOffer:u},voucher:{type:s.join(",")}}}}}]);